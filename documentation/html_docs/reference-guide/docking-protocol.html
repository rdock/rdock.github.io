<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="System definition file" href="system-definition-file.html" /><link rel="prev" title="Scoring functions" href="scoring-functions.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Docking protocol - rDock 1.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle-dock.css?v=918bf6c2" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">rDock 1.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/rdocklogo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">rDock 1.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">GNU LESSER GENERAL PUBLIC LICENSE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code-of-counduct.html">Contributor Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code-of-merit.html">Code of Merit</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-guide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-guide/quick-and-dirty-installation.html">Quick and dirty installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-guide/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-guide/unpacking.html">Unpacking the distribution files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-guide/building.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-guide/validation-experiments.html">Validation experiments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="cavity-mapping.html">Cavity mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="scoring-functions.html">Scoring functions</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Docking protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="system-definition-file.html">System definition file</a></li>
<li class="toctree-l1"><a class="reference internal" href="atom-typing.html">Molecular files and atom typing</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-formats.html">File formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="programs.html">Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/docking-in-3-steps.html">Docking in 3 steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/docking-strategies.html">Docking strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/multi-step-protocol-for-htvs.html">Multi-step protocol for HTVS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/calculating-roc-curves.html">Calculating ROC curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/running-docking-jobs-in-parallel.html">Running docking jobs in parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/pharmacophoric-restraints.html">Pharmacophoric restraints</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="docking-protocol">
<span id="id1"></span><h1>Docking protocol<a class="headerlink" href="#docking-protocol" title="Link to this heading">#</a></h1>
<section id="protocol-summary">
<h2>Protocol summary<a class="headerlink" href="#protocol-summary" title="Link to this heading">#</a></h2>
<section id="pose-generation">
<h3>Pose generation<a class="headerlink" href="#pose-generation" title="Link to this heading">#</a></h3>
<p>rDock uses a combination of stochastic and deterministic search techniques to
generate low energy ligand poses. The standard docking protocol to generate a
single ligand pose uses 3 stages of genetic algorithm search (GA1, GA2, GA3),
followed by low temperature Monte Carlo (MC) and simplex minimisation (MIN)
stages.</p>
<p>Several scoring function parameters are varied between the stages to promote
efficient sampling. The ECUT parameter of the <span class="math notranslate nohighlight">\(S_{\text{inter}}\)</span> vdW
potential (defining the hardness of the intermolecular close range potential)
is increased from 1 in the first GA stage (GA1) to a maximum of 120 in the MC
and MIN stages, with intermediate values of 5 in GA2 and 25 in GA3. The
functional form of the <span class="math notranslate nohighlight">\(S_{\text{inter}}\)</span> vdW potential is switched from
a 4-8 potential in GA1 and GA2 to a 6-12 potential in GA3, MC and MIN.</p>
<p>In a similar fashion, the overall weight of the <span class="math notranslate nohighlight">\(S_{\text{intra}}\)</span>
dihedral potential is ramped up from an initial value of 0.1 in GA1 to a final
value of 0.5 in the MC and MIN stages, with intermediate values of 0.2 in GA2
and 0.3 in GA3. In contrast, the <span class="math notranslate nohighlight">\(S_{\text{intra}}\)</span> vdW parameters (as
used for the ligand intramolecular potential) remain fixed at the final, hard
values throughout the calculation (ECUT = 120, 6-12 potential).</p>
<p>Overall, we found this combination of parameter changes allows for efficient
sampling of the very poor starting poses, whilst minimising the likelihood that
poor ligand internal conformations are artificially favoured and trapped early
in the search, and ensures that physically realistic potentials are used for
final optimisation and analysis.</p>
</section>
<section id="genetic-algorithm">
<span id="docking-protocol-genetic-algorithm"></span><h3>Genetic algorithm<a class="headerlink" href="#genetic-algorithm" title="Link to this heading">#</a></h3>
<p>The GA chromosome consists of the ligand centre of mass (com), the ligand
orientation, as represented by the quaternion (q) required to rotate the ligand
principal axes from the Cartesian reference axes, the ligand rotatable dihedral
angles, and the receptor rotatable dihedral angles. The ligand centre of mass
and orientation descriptors, although represented by multiple floating point
values (com.x, com.y, com.z, and q.s, q.x, q.y, q.z respectively), are operated
on as intact entities by the GA mutation and crossover operators.</p>
<p>For so-called free docking, in which no external restraints other than the
cavity penalty are imposed, the initial population is generated such that the
ligand centre of mass is constrained to lie on a randomly selected grid point
within the defined docking volume, and the ligand orientation and all dihedral
angles are randomised completely. Mutations to the ligand centre of mass are by
a random distance along a randomly oriented unit vector. Mutations to the ligand
orientation are performed by rotating the ligand principal axes by a random
angle around a randomly oriented unit vector. Mutations to the ligand and
receptor dihedral angles are by a random angle. All mutation distances and
angles are randomly selected from rectangular distributions of defined width.</p>
<p>A generation is considered to have passed when the number of new individuals
created is equal to the population size. Instead of having a fixed number of
generations, the GA is allowed to continue until the population converges. The
population is considered converged when the score of the best scoring pose fails
to improve by more than 0.1 over the last three generations. This allows early
termination of poorly performing runs for which the initial population is not
able to generate a good solution.</p>
<p>During initial testing the impact of a wide variety of GA parameters
(<a class="reference internal" href="#table-ga-parameter-space"><span class="std std-numref">Table 7</span></a>) were explored on a small,
representative set of protein-ligand complexes (3ptb, 1rbp, 1stp, 3dfr). We
measured the frequency that the algorithm was able to find the experimental
conformation, and the average run time. Optimum results were obtained with a
steady state GA, roulette wheel selection, a single population of size
(<span class="math notranslate nohighlight">\(100 \times \text{(number of rotatable bonds)}\)</span>), a crossover:mutation
ratio of 40:60, and mutation distribution widths of ligand translation 2 Å,
ligand rotation of 30 degrees and dihedral angle of 30 degrees. These parameters
have been found to be generally robust across a wide variety of systems.</p>
<div class="table-wrapper docutils container" id="id2">
<span id="table-ga-parameter-space"></span><span id="table-ga-parameter-space"></span><table class="docutils align-default" id="id2">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Summary of GA parameter space explored, and final values</span><a class="headerlink" href="#id2" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Values Explored</p></th>
<th class="head"><p>Final Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Number of populations</p></td>
<td><p>1, 2, 3, 4, 5</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Selection operator</p></td>
<td><p>Roulette wheel, Rank</p></td>
<td><p>Roulette wheel</p></td>
</tr>
<tr class="row-even"><td><p>Mutation</p></td>
<td><p>Rectangular Cauchy</p></td>
<td><p>Rectangular</p></td>
</tr>
<tr class="row-odd"><td><p>GA</p></td>
<td><p>Generational, Steady state</p></td>
<td><p>Steady state</p></td>
</tr>
<tr class="row-even"><td><p>Elitism</p></td>
<td><p>Yes, No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>No of individuals modified
in each generation</p></td>
<td><p>All values from 1 to population size</p></td>
<td><p>0.5 * population size</p></td>
</tr>
<tr class="row-even"><td><p>Population size</p></td>
<td><p>50, 75, 100, 125, 150, 200, 400, 800 * number
of rotatable bonds</p></td>
<td><p>100 * number of rotatable bonds</p></td>
</tr>
<tr class="row-odd"><td><p>Probability of choosing
Crossover vs. Mutation</p></td>
<td><p>0.0, 0.05, 0.1 … 0.9, 0.95, 1.0</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-even"><td><p>Torsion step</p></td>
<td><p>3, 12, 21, 30 degrees</p></td>
<td><p>30 degrees</p></td>
</tr>
<tr class="row-odd"><td><p>Rotational step</p></td>
<td><p>3, 12, 21, 30 degrees</p></td>
<td><p>30 degrees</p></td>
</tr>
<tr class="row-even"><td><p>Translation step</p></td>
<td><p>0.1, 0.8, 1.4, 2.0 Å</p></td>
<td><p>2.0 Å</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="monte-carlo">
<h3>Monte Carlo<a class="headerlink" href="#monte-carlo" title="Link to this heading">#</a></h3>
<p>The method and parameters for low temperature Monte Carlo are similar to those
described for phase 4 of the RiboDock simulated annealing search protocol. The
overall number of trials is scaled according to the number of rotatable bonds in
the ligand, from a minimum of 500 (<span class="math notranslate nohighlight">\(N_{\text{rot}} = 0\)</span>) to a maximum of
2000 (<span class="math notranslate nohighlight">\(N_{\text{rot}} = 15\)</span>). Maximum step sizes are: translation 0.1 Å,
ligand rotation of 10 degrees and dihedral angle of 10 degrees. Step sizes are
halved if the Metropolis acceptance rate falls below 0.25.</p>
</section>
<section id="simplex">
<h3>Simplex<a class="headerlink" href="#simplex" title="Link to this heading">#</a></h3>
<p>The Nelder-Mead’s simplex minimisation routine operates on the same chromosome
representation as the GA, with the exception that the composite descriptors
(centre of mass and orientation) are decomposed into their constituent floating
point values.</p>
</section>
</section>
<section id="code-implementation">
<h2>Code implementation<a class="headerlink" href="#code-implementation" title="Link to this heading">#</a></h2>
<p>Docking protocols are constructed at run-time (by <code class="docutils literal notranslate"><span class="pre">RbtTransformFactory</span></code> class)
from docking protocol definition files (rDock .prm format). The default location
for docking protocol files is <code class="docutils literal notranslate"><span class="pre">$RBT_ROOT/data/scripts/</span></code>. The docking protocol
definition file defines the sequence of search algorithms that constitute a
single docking run for a single ligand record. Each search algorithm component
operates either on a single chromosome representing the system degrees of
freedom, or on a population of such chromosomes. The chromosome is constructed
(by <code class="docutils literal notranslate"><span class="pre">RbtChromFactory</span></code> class) as an aggregate of individual chromosome elements
for the receptor, ligand and explicit solvent degrees of freedom, as defined by
the flexibility parameters in the system definition file.</p>
<div class="table-wrapper docutils container" id="id3">
<table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">Chromosome elements</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Element</p></th>
<th class="head"><p>Defined by</p></th>
<th class="head"><p>Class</p></th>
<th class="head"><p>Length</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Position</p></td>
<td><p>Centre of mass</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtChromPositionElement</span></code></p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>Orientation</p></td>
<td><p>Euler angles for
principal axes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtChromPositionElement</span></code></p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>Dihedral</p></td>
<td><p>Dihedral angle for
rotatable bond</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtChromDihedralElement</span></code></p></td>
<td><p>1 per
bond</p></td>
</tr>
<tr class="row-odd"><td><p>Occupancy</p></td>
<td><p>Explicit water
occupancy state</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtChromOccupancylElement</span></code></p></td>
<td><p>1 per
water</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="standard-dock-docking-protocol-dock-prm">
<h2>Standard rDock docking protocol (<code class="docutils literal notranslate"><span class="pre">dock.prm</span></code>)<a class="headerlink" href="#standard-dock-docking-protocol-dock-prm" title="Link to this heading">#</a></h2>
<p>As stated above in this section, the standard rDock docking protocol consists of
three phases of a genetic algorithm search, followed by low-temperature Monte
Carlo and simplex minimisation.</p>
<div class="table-wrapper docutils container" id="id4">
<table class="docutils align-default" id="id4">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">Search algorithm components and C++ implementation classes</span><a class="headerlink" href="#id4" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Class</p></th>
<th class="head"><p>Operates on</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Randomise population</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtRandPopTransform</span></code></p></td>
<td><p>Chromosome population</p></td>
</tr>
<tr class="row-odd"><td><p>Genetic algorithm
search</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtGATransform</span></code></p></td>
<td><p>Chromosome population</p></td>
</tr>
<tr class="row-even"><td><p>Monte Carlo
simulated annealing</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtSimAnnTransform</span></code></p></td>
<td><p>Single chromosome</p></td>
</tr>
<tr class="row-odd"><td><p>Simplex minimisation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtSimplexTransform</span></code></p></td>
<td><p>Single chromosome</p></td>
</tr>
<tr class="row-even"><td><p>Null operation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RbtNullTransform</span></code></p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper docutils container" id="id5">
<table class="docutils align-default" id="id5">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Docking protocol data files</span><a class="headerlink" href="#id5" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>File</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">score.prm</span></code></p></td>
<td><p>Calculates score only for initial conformation
(standard scoring function)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">scole_solv.prm</span></code></p></td>
<td><p>As above, but uses desolvation scoring function</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">minimise.prm</span></code></p></td>
<td><p>Simplex minimisation of initial conformation
(standard scoring function)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">minimise_solv.prm</span></code></p></td>
<td><p>As above, but uses desolvation scoring function</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dock.prm</span></code></p></td>
<td><p>Full docking search (standard scoring function)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dock_solv.prm</span></code></p></td>
<td><p>As above, but uses desolvation scoring function</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dock_grid.prm</span></code></p></td>
<td><p>Full docking search (standard scoring function,
grid-based vdW term)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dock_solv_grid.prm</span></code></p></td>
<td><p>Full docking search (desolvation scoring
function, grid-based vdW term)</p></td>
</tr>
</tbody>
</table>
</div>
<p>By way of example, the <code class="docutils literal notranslate"><span class="pre">dock.prm</span></code> script is documented in detail. The other
scripts are very similar.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">SCORE</span>
   <span class="n">INTER</span> <span class="n">RbtInterIdxSF</span><span class="o">.</span><span class="n">prm</span>
   <span class="n">INTRA</span> <span class="n">RbtIntraSF</span><span class="o">.</span><span class="n">prm</span>
   <span class="n">SYSTEM</span> <span class="n">RbtTargetSF</span><span class="o">.</span><span class="n">prm</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p><strong>Scoring Function</strong> The scoring function definition is referenced within the
docking protocol definition file itself, in the <code class="docutils literal notranslate"><span class="pre">SCORE</span></code> section. This section
contains entries for the <code class="docutils literal notranslate"><span class="pre">INTER</span></code>, <code class="docutils literal notranslate"><span class="pre">INTRA</span></code> and <code class="docutils literal notranslate"><span class="pre">SYSTEM</span></code> scoring function
definition files.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">SETSLOPE_1</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtNullTransform</span>
   <span class="c1"># Dock with a high penalty for leaving the cavity</span>
   <span class="n">WEIGHT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">RESTR</span><span class="o">.</span><span class="n">CAVITY</span> <span class="mf">5.0</span>
   <span class="c1"># Gradually ramp up dihedral weight from 0.1--&gt;0.5</span>
   <span class="n">WEIGHT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTRA</span><span class="o">.</span><span class="n">DIHEDRAL</span> <span class="mf">0.1</span>
   <span class="c1"># Gradually ramp up energy cut off for switching to quadratic</span>
   <span class="n">ECUT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">VDW</span> <span class="mf">1.0</span>
   <span class="c1"># Start docking with a 4-8 vdW potential</span>
   <span class="n">USE</span> <span class="mi">4_8</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">VDW</span> <span class="n">TRUE</span>
   <span class="c1"># Broader angular dependence</span>
   <span class="n">DA1MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">180.0</span>
   <span class="c1"># Broader angular dependence</span>
   <span class="n">DA2MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">180.0</span>
   <span class="c1"># Broader distance range</span>
   <span class="n">DR12MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">1.5</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p><strong>Genetic algorithm</strong> All sections that contain the <code class="docutils literal notranslate"><span class="pre">TRANSFORM</span></code> parameter are
interpreted as a search algorithm component. The value of the <code class="docutils literal notranslate"><span class="pre">TRANSFORM</span></code>
parameter is the C++ implementation class name for that transform. An
<code class="docutils literal notranslate"><span class="pre">RbtNullTransform</span></code> can be used to send messages to the scoring function to
modify key scoring function parameters in order to increase search efficiency.
All parameter names that contain the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbol are interpreted as scoring
function messages, where the string before the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> is the scoring function
parameter name, the string after the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> is the scoring function term, and the
parameter value is the new value for the scoring function parameter. Messages
are sent blind, with no success feedback, as the docking protocol has no
knowledge of the composition of the scoring function terms.</p>
<p>Here, we start the docking with a soft 4-8 vdW potential, a reduced dihedral
potential, and extended polar ranges (distances and angles) for the
intermolecular polar potential. These changes are all designed to aid sampling
efficiency by not overpenalising bad contacts in the initial, randomised
population, and by encouraging the formation of intermolecular hydrogen bonds.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">RANDOM_POP</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtRandPopTransform</span>
   <span class="n">POP_SIZE</span> <span class="mi">50</span>
   <span class="n">SCALE_CHROM_LENGTH</span> <span class="n">TRUE</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p>Creates an initial, randomised chromosome population. If <code class="docutils literal notranslate"><span class="pre">SCALE_CHROM_LENGTH</span></code>
is false, the population is of fixed size, defined by <code class="docutils literal notranslate"><span class="pre">POP_SIZE</span></code>. If
<code class="docutils literal notranslate"><span class="pre">SCALE_CHROM_LENGTH</span></code> is true, the population is proportional to the overall
chromosome length, defined by <code class="docutils literal notranslate"><span class="pre">POP_SIZE</span></code> multiplied by the chromosome length.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">GA_SLOPE1</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtGATransform</span>
   <span class="n">PCROSSOVER</span> <span class="mf">0.4</span> <span class="c1"># Prob. of crossover</span>
   <span class="n">XOVERMUT</span> <span class="n">TRUE</span> <span class="c1"># Cauchy mutation after each crossover</span>
   <span class="n">CMUTATE</span> <span class="n">FALSE</span> <span class="c1"># True = Cauchy; False = Rectang. for regular mutations</span>
   <span class="n">STEP_SIZE</span> <span class="mf">1.0</span> <span class="c1"># Max relative mutation</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p>First round of GA.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">SETSLOPE_3</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtNullTransform</span>
   <span class="n">WEIGHT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTRA</span><span class="o">.</span><span class="n">DIHEDRAL</span> <span class="mf">0.2</span>
   <span class="n">ECUT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">VDW</span> <span class="mf">5.0</span>
   <span class="n">DA1MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">140.0</span>
   <span class="n">DA2MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">140.0</span>
   <span class="n">DR12MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">1.2</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p>Increases the ligand dihedral weight, increases the short-range intermolecular
vdW hardness (ECUT), and decreases the range of the intermolecular polar
distances and angles.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">GA_SLOPE3</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtGATransform</span>
   <span class="n">PCROSSOVER</span> <span class="mf">0.4</span> <span class="c1"># Prob. of crossover</span>
   <span class="n">XOVERMUT</span> <span class="n">TRUE</span> <span class="c1"># Cauchy mutation after each crossover</span>
   <span class="n">CMUTATE</span> <span class="n">FALSE</span> <span class="c1"># True = Cauchy ; False = Rectang. for regular mutations</span>
   <span class="n">STEP_SIZE</span> <span class="mf">1.0</span> <span class="c1"># Max relative mutation</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p>Second round of GA with revised scoring function parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">SETSLOPE_5</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtNullTransform</span>
   <span class="n">WEIGHT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTRA</span><span class="o">.</span><span class="n">DIHEDRAL</span> <span class="mf">0.3</span>
   <span class="n">ECUT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">VDW</span> <span class="mf">25.0</span>
   <span class="c1"># Now switch to a convential 6-12 for final GA, MC, minimisation</span>
   <span class="n">USE</span> <span class="mi">4_8</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">VDW</span> <span class="n">FALSE</span>
   <span class="n">DA1MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">120.0</span>
   <span class="n">DA2MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">120.0</span>
   <span class="n">DR12MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">0.9</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p>Further increases the ligand dihedral weight, further increases the short-range
intermolecular vdW hardness (ECUT), and further decreases the range of the
intermolecular polar distances and angles. Also switches from softer 4-8 vdW
potential to a harder 6-12 potential for final round of GA, MC and minimisation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">GA_SLOPE5</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtGATransform</span>
   <span class="n">PCROSSOVER</span> <span class="mf">0.4</span> <span class="c1"># Prob. of crossover</span>
   <span class="n">XOVERMUT</span> <span class="n">TRUE</span> <span class="c1"># Cauchy mutation after each crossover</span>
   <span class="n">CMUTATE</span> <span class="n">FALSE</span> <span class="c1"># True = Cauchy ; False = Rectang. for regular mutations</span>
   <span class="n">STEP_SIZE</span> <span class="mf">1.0</span> <span class="c1"># Max relative mutation</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p>Final round of GA with revised scoring function parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">SETSLOPE_10</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtNullTransform</span>
   <span class="n">WEIGHT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTRA</span><span class="o">.</span><span class="n">DIHEDRAL</span> <span class="mf">0.5</span> <span class="c1"># Final dihedral weight matches SF file</span>
   <span class="n">ECUT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">VDW</span> <span class="mf">120.0</span> <span class="c1"># Final ECUT matches SF file</span>
   <span class="n">DA1MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">80.0</span>
   <span class="n">DA2MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">100.0</span>
   <span class="n">DR12MAX</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">INTER</span><span class="o">.</span><span class="n">POLAR</span> <span class="mf">0.6</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p>Resets all the modified scoring function parameters to their final values,
corresponding to the values in the scoring function definition files. It is
important that the final scoring function optimised by the docking search can be
compared directly with the score-only and minimisation-only protocols, in which
the scoring function parameters are not modified.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">MC_10K</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtSimAnnTransform</span>
   <span class="n">START_T</span> <span class="mf">10.0</span>
   <span class="n">FINAL_T</span> <span class="mf">10.0</span>
   <span class="n">NUM_BLOCKS</span> <span class="mi">5</span>
   <span class="n">STEP_SIZE</span> <span class="mf">0.1</span>
   <span class="n">MIN_ACC_RATE</span> <span class="mf">0.25</span>
   <span class="n">PARTITION_DIST</span> <span class="mf">8.0</span>
   <span class="n">PARTITION_FREQ</span> <span class="mi">50</span>
   <span class="n">HISTORY_FREQ</span> <span class="mi">0</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p><strong>Monte Carlo</strong> Low temperature Monte Carlo sampling, starting from fittest
chromosome from final round of GA.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">SIMPLEX</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtSimplexTransform</span>
   <span class="n">MAX_CALLS</span> <span class="mi">200</span>
   <span class="n">NCYCLES</span> <span class="mi">20</span>
   <span class="n">STOPPING_STEP_LENGTH</span> <span class="mf">10e-4</span>
   <span class="n">PARTITION_DIST</span> <span class="mf">8.0</span>
   <span class="n">STEP_SIZE</span> <span class="mf">1.0</span>
   <span class="n">CONVERGENCE</span> <span class="mf">0.001</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p><strong>Minimisation</strong> Simplex minimisation, starting from fittest chromosome from low
temperature Monte Carlo sampling.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECTION</span> <span class="n">FINAL</span>
   <span class="n">TRANSFORM</span> <span class="n">RbtNullTransform</span>
   <span class="n">WEIGHT</span><span class="nd">@SCORE</span><span class="o">.</span><span class="n">RESTR</span><span class="o">.</span><span class="n">CAVITY</span> <span class="mf">1.0</span> <span class="c1"># revert to standard cavity penalty</span>
<span class="n">END_SECTION</span>
</pre></div>
</div>
<p>Finally, we reset the cavity restraint penalty to 1. The penalty has been held
at a value of 5 throughout the search, to strongly discourage the ligand from
leaving the docking site.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="system-definition-file.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">System definition file</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="scoring-functions.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Scoring functions</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2012 – 2023, rDock development team;
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Docking protocol</a><ul>
<li><a class="reference internal" href="#protocol-summary">Protocol summary</a><ul>
<li><a class="reference internal" href="#pose-generation">Pose generation</a></li>
<li><a class="reference internal" href="#genetic-algorithm">Genetic algorithm</a></li>
<li><a class="reference internal" href="#monte-carlo">Monte Carlo</a></li>
<li><a class="reference internal" href="#simplex">Simplex</a></li>
</ul>
</li>
<li><a class="reference internal" href="#code-implementation">Code implementation</a></li>
<li><a class="reference internal" href="#standard-dock-docking-protocol-dock-prm">Standard rDock docking protocol (<code class="docutils literal notranslate"><span class="pre">dock.prm</span></code>)</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=fc837d61"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>